#!/usr/bin/env bash

# this is what TAB will insert.
# default value is "  "
tabchar="  "

# create a shell function with a name and edit contents.
# not horribly useful, but a good showcase of bim's extensibility.
bim_shellfunc() {
	# name defaults to func if not given
	[ "$1" ] && name="$1" || name="func"
	# create 3 lines
	bim_blank 3
	# create function skeleton
	buffer[line+1]="${name}() {"
	buffer[line+2]="${tabchar}"
	buffer[line+3]="}"
	# edit contents
	bim_down 2; bim_edit
}

# 'keybinds' is a special function that is called every time a key is pressed.
# on start, bim checks to see if it is defined.
# these keybinds are defaults, with the addition of F for 'bim_shellfunc'
keybinds() {
    case "${key}" in
    
        # motions
        k) bim_up 1;;
        j) bim_down 1;;
        K) bim_up $((LINES - 4));;
        J) bim_down $((LINES - 4));;
		g) bim_bof;;
		G) bim_eof;;
        t) cursor show
           bim_goto "$(misc_prompt "goto: ")"
           cursor hide
           ;;

        # editing
        a) bim_edit;;
        I) bim_prepend;;
        d) bim_delete;;
        c) bim_clear;;
        o) bim_insert;;
        O) bim_backinsert;;
        n) bim_blank 1; bim_down 1;;
        N) bim_backblank 1;;
        y) bim_yank;;
        p) bim_paste; bim_down 1;;
    
        # misc
        :) bim_prompt;;
		z) bim_center;;

		# shell function example
		F) cursor show
		   bim_shellfunc "$(misc_prompt "shell function: ")" $tabstop
		   cursor hide
		   ;;
    esac
}
